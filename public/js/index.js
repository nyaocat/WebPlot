// Generated by CoffeeScript 1.6.3
$(function() {
  var rff, rndr;
  console.log("loaded");
  rff = function() {
    return false;
  };
  rndr = function() {
    var $form;
    $("#myModal").modal("toggle");
    $form = $(this);
    $("#myBar").css("display", "block");
    $("#myImg").css("display", "none");
    $("#rndMes").css("display", "none");
    $("#dBtn").addClass("disabled");
    $.post("/rnder", $form.serialize(), (function(p) {
      $("#myBar").css("display", "none");
      if (p.err != null) {
        $("#rndMes").css("display", "block");
        return $("#rndMes").text(p.err);
      } else {
        $("#myImg").css("display", "block");
        $("#myImg").attr("src", p.thumb);
        $("#dBtn").removeClass("disabled");
        return $("#dBtn").attr("href", "/download/" + p.thumb);
      }
    }), "json");
    return false;
  };
  $("#thatForm").submit(rff);
  return $("#dataFile").change(function() {
    $("#thatForm").unbind('submit');
    return $(this).upload("/upp", (function(res) {
      console.log(res);
      $("#thatSubmit").removeClass("disabled");
      $("#dataPath").val(res);
      return $("#thatForm").submit(rndr);
    }), "text");
  });
});
